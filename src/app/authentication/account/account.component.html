<div class="new-back">

  <div class="new-header">
    <div class="container">
      <div *ngIf="alertValidationNumber === 1">
        {{alertValidationError()}}
        <p [innerHTML]="alertValidationMessage"></p>
        <br/><br/>
      </div>

      <h1>
        Account:
      </h1>
      <h4>
        Review the account details and change anything that needs to be updated
      </h4>
    </div>
  </div>

  <div class="new-main">
    <div class="container">
      <div class="row">

        <div class="col-md-8 mx-auto">
          <div class="container">
            <h2 class="text-center pb-3">
              Account Details:
            </h2>

            <div class="card card-shadow-hard pt-4 pb-2 px-2 mb-5">
              <div class="container">
                <div class="row">
                  <div class="col-8" *ngIf="formBasicSet">
                    <form [formGroup]="accountFormBasic" (ngSubmit)="submit(accountFormBasic.value)">
                      <h4 class="new-sub-heading mt-2 mb-5 w-100">
                        Change the contact information?
                      </h4>

                      <div class="row">
                        <div class="form-group col-12 pb-2">
                          <label for="name">Name</label>
                          <input type="text"
                                 class="form-control"
                                 id="name"
                                 placeholder="John Doe"
                                 formControlName="name"
                                 (change)="updateForm()"
                          >
                        </div>

                        <div class="form-group col-12 pb-3">
                          <label for="email">Email Address</label>
                          <input type="text"
                                 class="form-control"
                                 id="email"
                                 placeholder="user@example.com"
                                 formControlName="email"
                                 (change)="updateForm()"
                          >
                          <control-messages [control]="accountFormBasic.controls.email"></control-messages>
                        </div>
                      </div>

                      <div *ngIf="!accountFormBasic.errors; else basic_form_errors">
                        <div *ngIf="this.alertNumber === 1">
                          {{alertRegistering()}}
                        </div>
                        <div *ngIf="this.alertNumber === 2">
                          {{alertSubmitted()}}
                        </div>
                        <div *ngIf="this.alertNumber === 3">
                          {{alertNetworkError()}}
                        </div>
                        <div *ngIf="this.alertNumber === 4">
                          {{alertReset()}}
                        </div>
                        <p [innerHTML]="alertMessage"></p>
                      </div>
                      <ng-template #basic_form_errors>
                        <p class="alert alert-danger" role="alert">
                          The email address '{{accountFormBasic.controls.email.value}}' has already been taken. Please enter a different email address.
                        </p>
                      </ng-template>
                      <div *ngIf="((accountFormBasic.dirty && accountFormBasic.touched) || (accountFormPassword.dirty && accountFormPassword.touched)) && alertMessage">
                        {{alertSetToReset()}}
                      </div>

                      <button type="button"
                        [hidden]="alertMessage"
                        class="btn btn-outline-secondary btn-lg w-100 mt-4 mb-2"
                        (click)="formBasicSet = false"
                      >
                        Change password?
                      </button>

                      <button type="submit"
                        [hidden]="alertMessage"
                        class="btn btn-primary btn-lg w-100 mt-4 mb-3"
                        [disabled]="!accountFormBasic.valid"
                      >
                        Update Account
                      </button>
                    </form>
                  </div>

                  <div class="col-8" *ngIf="!formBasicSet">
                    <form [formGroup]="accountFormPassword" (ngSubmit)="submit(accountFormPassword.value)">
                      <h4 class="new-sub-heading mt-2 mb-5 w-100">
                        Change the contact information?
                      </h4>

                      <div class="row">
                        <div class="form-group col-12 pb-2">
                          <label for="name">Name</label>
                          <input type="text"
                                 class="form-control"
                                 id="name"
                                 placeholder="John Doe"
                                 formControlName="name"
                                 (change)="updateForm()"
                          >
                        </div>

                        <div class="form-group col-12 pb-3">
                          <label for="email">Email Address</label>
                          <input type="text"
                                 class="form-control"
                                 id="email"
                                 placeholder="user@example.com"
                                 formControlName="email"
                                 (change)="updateForm()"
                          >
                          <control-messages [control]="accountFormPassword.controls.email"></control-messages>
                        </div>
                      </div>

                      <h4 class="new-sub-heading mt-5 mb-5">
                        Change the password?
                      </h4>

                      <div class="row">
                        <div class="form-group col-12">
                          <label for="password">Password</label>
                          <input type="password"
                                 class="form-control"
                                 id="password"
                                 formControlName="password"
                          >
                          <control-messages [control]="accountFormPassword.controls.password"></control-messages>
                          <small id="passwordHelpBlock" class="form-text text-muted">
                            Must be 8-20 characters long with letters and numbers. Adding symbols are recommended.
                          </small>
                        </div>

                        <div class="form-group col-12 mb-5">
                          <label for="passwordConfirmation">Confirm Password</label>
                          <input type="password"
                                 class="form-control"
                                 id="passwordConfirmation"
                                 formControlName="passwordConfirmation"
                          >
                          <control-messages [control]="accountFormPassword.controls.passwordConfirmation"></control-messages>

                          <div class="form-group alert alert-danger mt-3" *ngIf="accountFormPassword.controls.passwordConfirmation.errors?.passwordMismatch">
                            Both passwords must match
                          </div>
                        </div>
                      </div>

                      <div *ngIf="!accountFormPassword.errors; else password_form_errors">
                        <div *ngIf="this.alertNumber === 1">
                          {{alertRegistering()}}
                        </div>
                        <div *ngIf="this.alertNumber === 2">
                          {{alertSubmitted()}}
                        </div>
                        <div *ngIf="this.alertNumber === 3">
                          {{alertNetworkError()}}
                        </div>
                        <div *ngIf="this.alertNumber === 4">
                          {{alertReset()}}
                        </div>
                        <p [innerHTML]="alertMessage"></p>
                      </div>
                      <ng-template #password_form_errors>
                        <p class="alert alert-danger" role="alert">
                          The email address '{{accountFormBasic.controls.email.value}}' has already been taken. Please enter a different email address.
                        </p>
                      </ng-template>
                      <div *ngIf="((accountFormBasic.dirty && accountFormBasic.touched) || (accountFormPassword.dirty && accountFormPassword.touched)) && alertMessage">
                        {{alertSetToReset()}}
                      </div>

                      <button type="button"
                        [hidden]="alertMessage"
                        class="btn btn-outline-secondary btn-lg w-100 mt-4 mb-2"
                        (click)="formBasicSet = true"
                      >
                        Basic data only?
                      </button>

                      <button type="submit"
                        [hidden]="alertMessage"
                        class="btn btn-primary btn-lg w-100 mt-4 mb-3"
                        [disabled]="!accountFormPassword.valid"
                      >
                        Update Account
                      </button>
                    </form>
                  </div>

                  <div class="col-4 new-sidebar">
                    <h3 class="new-sub-heading">
                      Cancel the account?
                    </h3>

                    <div [hidden]="deleteConfirm || deletingData">
                      <p>
                        Are you sure you want to cancel your account? Canceling the account will perminantly delete your account information.
                      </p>
                      <button type="button"
                        class="btn btn-danger btn-lg w-100 mt-2"
                        (click)="deleteConfirm = true"
                      >
                        Cancel Account
                      </button>
                    </div>

                    <div [hidden]="!deleteConfirm || deletingData">
                      <p class="mt-2 text-danger">
                        Are you sure you want to cancel your account? Your account information will be perminantly deleted if you cancel it.
                      </p>
                      <button type="button"
                        class="btn btn-danger btn-lg mx-2"
                        (click)="loginDeleteVerification()"
                      >
                        Yes
                      </button>
                      <button type="button"
                        class="btn btn-primary btn-lg mx-2"
                        (click)="deleteConfirm = false"
                      >
                        No
                      </button>
                    </div>

                    <div *ngIf="alertValidationNumber === 2">
                      {{alertDeleteValidationError()}}
                      <p [innerHTML]="alertValidationMessage"></p>
                      <br/><br/>
                    </div>

                    <div *ngIf="this.alertDeleteNumber === 1">
                      {{alertDeleting()}}
                    </div>
                    <div *ngIf="this.alertDeleteNumber === 2">
                      {{alertDeleteSubmitted()}}
                    </div>
                    <div *ngIf="this.alertDeleteNumber === 3">
                      {{alertDeleteNetworkError()}}
                    </div>
                    <div *ngIf="this.alertDeleteNumber === 4">
                      {{alertDeleteReset()}}
                    </div>
                    <p [innerHTML]="alertDeleteMessage"></p>

                    <div *ngIf="((accountFormBasic.dirty && accountFormBasic.touched) || (accountFormPassword.dirty && accountFormPassword.touched)) && alertDeleteMessage">
                      {{alertDeleteSetToReset()}}
                    </div>

                    <div class="corner-bottom-right">
                      <a (click)="logOut()" *ngIf="isLoggedIn()">Logout</a>
                    </div>
                  </div>
                </div>

              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>